So now, let's talk about

CloudFormation custom resources.

So as we said, many, many resources

are supported by CloudFormation.

But you have custom resources to define resources

that are not yet supported by CloudFormation

or to define custom provisioning logic

for resources that can be outside of CloudFormation.

For example, your own on-premises resources

or your third-party resources,

or if you want to have custom scripts

being run during the create, update,

and delete phases of your CloudFormation stack

through Lambda functions.

And one example I will give you, again,

is to run a Lambda function to empty and S3 bucket

before being deleted.

And this is a common exam question.

So to define a custom resource,

you define it in the template, and the type of it

is Custom::MyCustomResourceTypeName.

is Custom::MyCustomResourceTypeName.

It's backed by either a Lambda function,

which is the most common one, or an SNS topic.

So how do we define a custom resource?

I will only go over the Lambda custom resource

because it's the most common one.

So we have a custom resource of type custom,

MyLambdaResource.

And then, in the properties, we have a service token.

And the service token is either your Lambda function, ARN,

or your SNS ARN.

They must be in the same region.

And the idea is that this Lambda function

is going to have its own logic

to provision your customer resource

or to do whatever it needs.

On top of it, thanks to input data parameters,

you can provide input values to your Lambda function.

So the use case, for example, as I said,

is to delete content from an S3 bucket

because it turns out that you cannot delete

a non-empty S3 bucket from CloudFormation.

So first, you must delete all the objects in it,

and then you delete the buckets.

To do so, you use a custom resource.

And the idea is that when that custom resource is deleted,

it's going to run API calls

to actually delete your S3 buckets.

So here's an example.

Whenever we run delete stack on CloudFormation,

then your custom resource backed by Lambda function

is going to run API calls to empty your S3 bucket.

And then only then,

when your S3 bucket is emptied,

then CloudFormation is going to actually attempt

to delete your S3 bucket,

and everything will work.

So that's the most common use case

from an example perspective.

And that's the one I wanted to show you

by the way of diagram.

So I hope you liked it,

and I will see you in the next lecture.


So here is one thing you need

to know about CloudFormation and security.

So CloudFormation can use service roles.

What are they?

Well, they are iam roles that you create

and they're dedicated to CloudFormation

and they allow CloudFormation

to actually create update

and delete stack resources on your behalf.

So if you want to give the ability to users

to actually create, update

and delete stack resources,

but they don't have the permissions

to directly work with the resources,

what you would do is use a service role.

So for example, we define a template

and our own iam permissions as a user is

to do actions on the CloudFormation.

And we have iam PassRole.

We also create a service role that we're going

to be dedicating to CloudFormation.

And this service role has the S3 star buckets,

permissions, for example,

to create, update and delete a bucket.

So here CloudFormation will be able

to create this S3 bucket thanks

to its service role because the user was able

to pass that role to CloudFormation.

So the use cases for security is if you want

to achieve the least privileged principle

and you don't want to give the users

all the permissions

to create the stack resources,

only the permissions

to invoke a service role on CloudFormation.

For this to work, remember the user

must have the permission named iam PassRole,

which is a necessary permission

to give a role to a specific service in AWS.

So let me show you an example

of iam roles with CloudFormation.

So if you go to iam and then you go

to the roles section in iam,

we're going to create a role

and it's for an AWS service,

the service being CloudFormation.

And next for permission policies,

I'm going to give S3 full access

just to have dedicated role for Amazon S3,

just as an example.

Click on next and I'll call

it DemoRole for CFN with S3 capabilities.

And so this role allows CloudFormation

to do anything with Amazon S3.

So this role has been created.

Now if I go to CloudFormation

and create a stack, I will just use one

of my existing templates.

I don't need to have anything very fancy.

We will not go all the way with it.

So I call this one DemoRole.

Click on next.

And as you can see here,

within permissions there is an iam role.

This is optional.

So if I don't specify, then iam role is going

to use my own personal permissions.

But if I want to specify an iam role,

I can look at this DemoRole

for CFN with S3 capabilities.

And this role is going to be used

for all stack operations.

So that means that the role now

will not use my own personal permissions,

but this one, and because this one

is just powered with Amazon S3 permissions,

then actually my stack will fail

because my stack is actually

creating an EC2 instance.

But this is where actually the permissions

are defined if you want

to use an iam role for CloudFormation.

And that's it.

So I hope you liked it and I will see you

in the next lecture.

